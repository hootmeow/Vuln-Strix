{{define "content"}}
<h2>Hosts</h2>

<div class="mb-3">
    <input type="text" id="hostSearch" class="form-control" placeholder="Search hosts by IP, Hostname or OS..."
        onkeyup="filterHosts()">
</div>

<div class="table-responsive">
    <table class="table table-striped table-sm" id="hostsTable">
        <thead>
            <tr>
                <th>IP Address</th>
                <th>Hostname</th>
                <th>OS</th>
                <th>Criticality</th>
                <th>Last Seen</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range .Hosts}}
            <tr>
                <td>{{.IP}}</td>
                <td>{{.Hostname}}</td>
                <td>{{.OS}}</td>
                <td><span class="badge {{if eq .Criticality " High"}}bg-danger{{else if eq .Criticality "Medium"
                        }}bg-warning text-dark{{else}}bg-info{{end}}">{{.Criticality}}</span></td>
                <td>{{.UpdatedAt.Format "2006-01-02 15:04"}}</td>
                <td><a href="/hosts/{{.ID}}" class="btn btn-sm btn-outline-primary">View</a></td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>

<script>
    function filterHosts() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("hostSearch");
        filter = input.value.toUpperCase();
        table = document.getElementById("hostsTable");
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            // Check IP, Hostname, and OS columns (Indices 0, 1, 2)
            var found = false;
            for (var j = 0; j <= 2; j++) {
                td = tr[i].getElementsByTagName("td")[j];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                        break;
                    }
                }
            }
            if (tr[i].getElementsByTagName("th").length > 0) continue; // Skip header

            if (found) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
</script>
</div>
{{end}}